CREATE OR REPLACE TABLE
    `devoteam-tech-challenge-456311.baseball.stg_events` AS
SELECT
    gameId,
    inningNumber,
    inningHalf,
    homeFinalRunsForInning,
    awayFinalRunsForInning,
    CASE
        WHEN inningEventType = 'LINEUP' THEN inningEventType
        WHEN atBatEventType IS NOT NULL THEN atBatEventType
        ELSE NULL
    END AS eventType,
    inningEventType,
    inningHalfEventSequenceNumber,
    description,
    atBatEventType,
    atBatEventSequenceNumber,
    createdAt,
    updatedAt,
    status,
    outcomeId,
    outcomeDescription,
    pitcherId,
    pitchType,
    pitchTypeDescription,
    pitchSpeed,
    pitchZone,
    pitcherPitchCount,
    hitterId,
    hitterPitchCount,
    hitLocation,
    hitType,
    startingBalls,
    startingStrikes,
    startingOuts,
    balls,
    strikes,
    outs,
    rob0_start,
    rob0_end,
    rob0_isOut,
    rob0_outcomeId,
    rob0_outcomeDescription,
    rob1_start,
    rob1_end,
    rob1_isOut,
    rob1_outcomeId,
    rob1_outcomeDescription,
    rob2_start,
    rob2_end,
    rob2_isOut,
    rob2_outcomeId,
    rob2_outcomeDescription,
    rob3_start,
    rob3_end,
    rob3_isOut,
    rob3_outcomeId,
    rob3_outcomeDescription,
    is_ab,
    is_ab_over,
    is_hit,
    is_on_base,
    is_bunt,
    is_bunt_shown,
    is_double_play,
    is_triple_play,
    is_wild_pitch,
    is_passed_ball,
    homeCurrentTotalRuns,
    awayCurrentTotalRuns,
    awayFielder1,
    awayFielder2,
    awayFielder3,
    awayFielder4,
    awayFielder5,
    awayFielder6,
    awayFielder7,
    awayFielder8,
    awayFielder9,
    awayFielder10,
    awayFielder11,
    awayFielder12,
    awayBatter1,
    awayBatter2,
    awayBatter3,
    awayBatter4,
    awayBatter5,
    awayBatter6,
    awayBatter7,
    awayBatter8,
    awayBatter9,
    homeFielder1,
    homeFielder2,
    homeFielder3,
    homeFielder4,
    homeFielder5,
    homeFielder6,
    homeFielder7,
    homeFielder8,
    homeFielder9,
    homeFielder10,
    homeFielder11,
    homeFielder12,
    homeBatter1,
    homeBatter2,
    homeBatter3,
    homeBatter4,
    homeBatter5,
    homeBatter6,
    homeBatter7,
    homeBatter8,
    homeBatter9,
    lineupTeamId,
    lineupPlayerId,
    lineupPosition,
    lineupOrder
FROM
    `devoteam-tech-challenge-456311.baseball.raw_games_wide_filtered`
UNION ALL
SELECT
    gameId,
    inningNumber,
    inningHalf,
    homeFinalRunsForInning,
    awayFinalRunsForInning,
    CASE
        WHEN inningEventType = 'LINEUP' THEN inningEventType
        WHEN atBatEventType IS NOT NULL THEN atBatEventType
        ELSE NULL
    END AS eventType,
    inningEventType,
    inningHalfEventSequenceNumber,
    description,
    atBatEventType,
    atBatEventSequenceNumber,
    createdAt,
    updatedAt,
    status,
    outcomeId,
    outcomeDescription,
    pitcherId,
    pitchType,
    pitchTypeDescription,
    pitchSpeed,
    pitchZone,
    pitcherPitchCount,
    hitterId,
    hitterPitchCount,
    hitLocation,
    hitType,
    startingBalls,
    startingStrikes,
    startingOuts,
    balls,
    strikes,
    outs,
    rob0_start,
    rob0_end,
    rob0_isOut,
    rob0_outcomeId,
    rob0_outcomeDescription,
    rob1_start,
    rob1_end,
    rob1_isOut,
    rob1_outcomeId,
    rob1_outcomeDescription,
    rob2_start,
    rob2_end,
    rob2_isOut,
    rob2_outcomeId,
    rob2_outcomeDescription,
    rob3_start,
    rob3_end,
    rob3_isOut,
    rob3_outcomeId,
    rob3_outcomeDescription,
    is_ab,
    is_ab_over,
    is_hit,
    is_on_base,
    is_bunt,
    is_bunt_shown,
    is_double_play,
    is_triple_play,
    is_wild_pitch,
    is_passed_ball,
    homeCurrentTotalRuns,
    awayCurrentTotalRuns,
    awayFielder1,
    awayFielder2,
    awayFielder3,
    awayFielder4,
    awayFielder5,
    awayFielder6,
    awayFielder7,
    awayFielder8,
    awayFielder9,
    awayFielder10,
    awayFielder11,
    awayFielder12,
    awayBatter1,
    awayBatter2,
    awayBatter3,
    awayBatter4,
    awayBatter5,
    awayBatter6,
    awayBatter7,
    awayBatter8,
    awayBatter9,
    homeFielder1,
    homeFielder2,
    homeFielder3,
    homeFielder4,
    homeFielder5,
    homeFielder6,
    homeFielder7,
    homeFielder8,
    homeFielder9,
    homeFielder10,
    homeFielder11,
    homeFielder12,
    homeBatter1,
    homeBatter2,
    homeBatter3,
    homeBatter4,
    homeBatter5,
    homeBatter6,
    homeBatter7,
    homeBatter8,
    homeBatter9,
    lineupTeamId,
    lineupPlayerId,
    lineupPosition,
    lineupOrder
FROM
    `devoteam-tech-challenge-456311.baseball.raw_games_wide_post`