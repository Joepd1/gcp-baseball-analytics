CREATE OR REPLACE TABLE
    `devoteam-tech-challenge-456311.baseball.test_batch_games_wide` AS
SELECT
    p.new_gameId as gameId,
    p.new_seasonId as seasonId,
    g.seasonType,
    2024 as year,
    TIMESTAMP(
        DATETIME_ADD(DATETIME(g.startTime), INTERVAL 8 YEAR)
    ) AS startTime,
    g.gameStatus,
    g.attendance,
    g.dayNight,
    g.duration,
    g.durationMinutes,
    g.awayTeamId,
    g.awayTeamName,
    g.homeTeamName,
    g.venueId,
    g.venueName,
    g.venueSurface,
    g.venueCapacity,
    g.venueCity,
    g.venueState,
    g.venueZip,
    g.venueMarket,
    g.venueOutfieldDistances,
    g.homeFinalRuns,
    g.homeFinalHits,
    g.homeFinalErrors,
    g.awayFinalRuns,
    g.awayFinalHits,
    g.awayFinalErrors,
    g.homeFinalRunsForInning,
    g.awayFinalRunsForInning,
    g.inningNumber,
    g.inningHalf,
    g.inningEventType,
    g.inningHalfEventSequenceNumber,
    g.description,
    g.atBatEventType,
    g.atBatEventSequenceNumber,
    TIMESTAMP(
        DATETIME_ADD(DATETIME(g.createdAt), INTERVAL 8 YEAR)
    ) AS createdAt,
    TIMESTAMP(
        DATETIME_ADD(DATETIME(g.updatedAt), INTERVAL 8 YEAR)
    ) AS updatedAt,
    g.status,
    g.outcomeId,
    g.outcomeDescription,
    g.hitterId,
    g.hitterLastName,
    g.hitterFirstName,
    g.hitterWeight,
    g.hitterHeight,
    g.hitterBatHand,
    g.pitcherId,
    g.pitcherFirstName,
    g.pitcherLastName,
    g.pitcherThrowHand,
    g.pitchType,
    g.pitchTypeDescription,
    g.pitchSpeed,
    g.pitchZone,
    g.pitcherPitchCount,
    g.hitterPitchCount,
    g.hitLocation,
    g.hitType,
    g.startingBalls,
    g.startingStrikes,
    g.startingOuts,
    g.balls,
    g.strikes,
    g.outs,
    g.rob0_start,
    g.rob0_end,
    g.rob0_isOut,
    g.rob0_outcomeId,
    g.rob0_outcomeDescription,
    g.rob1_start,
    g.rob1_end,
    g.rob1_isOut,
    g.rob1_outcomeId,
    g.rob1_outcomeDescription,
    g.rob2_start,
    g.rob2_end,
    g.rob2_isOut,
    g.rob2_outcomeId,
    g.rob2_outcomeDescription,
    g.rob3_start,
    g.rob3_end,
    g.rob3_isOut,
    g.rob3_outcomeId,
    g.rob3_outcomeDescription,
    g.is_ab,
    g.is_ab_over,
    g.is_hit,
    g.is_on_base,
    g.is_bunt,
    g.is_bunt_shown,
    g.is_double_play,
    g.is_triple_play,
    g.is_wild_pitch,
    g.is_passed_ball,
    g.homeCurrentTotalRuns,
    g.awayCurrentTotalRuns,
    g.awayFielder1,
    g.awayFielder2,
    g.awayFielder3,
    g.awayFielder4,
    g.awayFielder5,
    g.awayFielder6,
    g.awayFielder7,
    g.awayFielder8,
    g.awayFielder9,
    g.awayFielder10,
    g.awayFielder11,
    g.awayFielder12,
    g.awayBatter1,
    g.awayBatter2,
    g.awayBatter3,
    g.awayBatter4,
    g.awayBatter5,
    g.awayBatter6,
    g.awayBatter7,
    g.awayBatter8,
    g.awayBatter9,
    g.homeFielder1,
    g.homeFielder2,
    g.homeFielder3,
    g.homeFielder4,
    g.homeFielder5,
    g.homeFielder6,
    g.homeFielder7,
    g.homeFielder8,
    g.homeFielder9,
    g.homeFielder10,
    g.homeFielder11,
    g.homeFielder12,
    g.homeBatter1,
    g.homeBatter2,
    g.homeBatter3,
    g.homeBatter4,
    g.homeBatter5,
    g.homeBatter6,
    g.homeBatter7,
    g.homeBatter8,
    g.homeBatter9,
    g.lineupTeamId,
    g.lineupPlayerId,
    g.lineupPosition,
    g.lineupOrder
FROM
    `devoteam-tech-challenge-456311.baseball.test_batch_games_wide` g
    JOIN `devoteam-tech-challenge-456311.baseball.test_gameIdsPivot_seasonId` p ON g.gameId = p.gameId